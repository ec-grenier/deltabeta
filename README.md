# Run delta beta for mortality

## What is delta beta?

Delta beta is a CIL tool which allows users to approximate impacts generated by the projection system. It builds mortality response functions as binned step functions, then applies those curves to temperature distributions. There are 3 types of responses:

1. Full adaptation: mortality response accounting for income and climate adaptation
2. Income adaptation: mortality response only accounting for income adaptation
3. No adaptation: mortality response with no income or climate adaptation

## How to run:

Before you using this repository, run a single projection for the combination of models that you would like to diagnose. This is to generate an "allcalcs" file containing long-run income and climate covariates as calculated by the projection system. The covariates are interacted with response function coefficients estimated by age group and jointly determine the shape of a region's curve. Coefficients from the main mortality model are located in `data/csvv/`.

1. Extract covariates from allcalcs files from the single projections generated. You can download covariate data for several models [here](https://uchicago.box.com/s/6pdjguq7pumaj9j03t64uealwdmyb2qr). If you are an RCC user, the data is here: `/project/cil/home_dirs/egrenier/cil-comms/deltabeta/data/covars`.
2. Run `1_mortality_db_script.R` from command line, R console, or using `run_db.sbatch`. See script for command line arguments to include.
3. (Optional) Combine impacts across age groups. Takes the age group share weighted average.
4. Plot response function (beta) and temperature distributions (delta)

